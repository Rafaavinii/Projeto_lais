{% extends 'base_autenticado.html' %}
{% load static %}


{% block 'head' %}
<style>
    .list-group-item.active {
        border: 2px solid green!important;
        background-color: white;
        color: black;
    }

</style>
{% endblock %}

{% block 'nome' %}
    {{ dados_usuario.nome }}
{% endblock %}
{% block 'data' %}
    {{ dados_usuario.idade }} anos ({{ dados_usuario.data_nascimento }}) 
{% endblock %}
{% block 'cpf' %}
    {{ dados_usuario.cpf }}
{% endblock %}
{% block 'apto' %}
    {{ dados_usuario.apto }}
{% endblock %}


{% block 'dashboard'%}

<div class="container">
    <form method="post" action="{% url 'agendamento:agendamento' %}">
        {% csrf_token %}
        {% for mensagem in messages %}
        {% if mensagem.tags == 'error' %}
            <div class="alert alert-danger mt-2" role="alert">
                {{ mensagem }}
            </div>
        {% endif %}
        {% endfor %}
            <div class="form-group">
                <label for="estabelecimento">Selecione um Grupo de Atendimento:</label>
                <select class="form-control" name="estabelecimento" id="estabelecimento">
                    {% for estabelecimento in estabelecimentos %}
                        <option value="{{ estabelecimento.codigo }},{{ estabelecimento.nome }}">{{ estabelecimento.codigo }} - {{ estabelecimento.nome }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <div class="container">
                    <div class="d-flex" id="itens">
                        {% for data in datas %}
                            <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ data }}" onclick="selecionarItem('{{ data }}')">{{ data }}</a>
                        {% endfor %}
                    </div>
                    <input type="hidden" name="data" id="data">
                </div>
            </div>
            <div class="form-group">
                <label for="horario">Selecione um Horario</label>
                <div class="d-flex" id="itens">
                    <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ hora }}:00" onclick="selecionarItem('{{ hora }}:00')">{{ hora }}:00</a>
                    <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ hora }}:12" onclick="selecionarItem('{{ hora }}:12')">{{ hora }}:12</a>
                    <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ hora }}:24" onclick="selecionarItem('{{ hora }}:24')">{{ hora }}:24</a>
                    <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ hora }}:36" onclick="selecionarItem('{{ hora }}:36')">{{ hora }}:36</a>
                    <a href="#" class="list-group-item list-group-item-action rounded-pill" data-item="{{ hora }}:48" onclick="selecionarItem('{{ hora }}:48 ')">{{ hora }}:48</a>
                </div>
                <input type="hidden" name="hora" id="hora">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                <button type="submit" class="btn custom-btn">Agendar</button>
            </div>
    </form>
</div>
<script>
    var itensSelecionados = [];

    function selecionarItem(item) {
        var elemento = document.querySelector('.list-group-item[data-item="' + item + '"]');
        if (elemento) {
            // Desmarca todos os itens
            document.querySelectorAll('.list-group-item').forEach(function(item) {
                item.classList.remove('active');
                });

                // Marca apenas o item clicado
                elemento.classList.add('active');

                // Atualiza o valor do campo hidden com o item selecionado
                document.getElementById('hora').value = item;
                document.getElementById('data').value = item;
        }
    }
</script>
{% endblock %}